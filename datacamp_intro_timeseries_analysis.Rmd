---
title: "DataCampe Intro to Time Series Analysis"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. 

# Chapter 1

## Fetching Data

```{r}
# Print the Nile dataset
print(Nile)

# List the number of observations in the Nile dataset
length(Nile)

# Display the first 10 elements of the Nile dataset
head(Nile, 10)

# Display the last 12 elements of the Nile dataset
tail(Nile, 12)

```
## Basic Plotting

```{r}
# Plot the Nile data
plot(Nile)

# Plot the Nile data with xlab and ylab arguments
plot(Nile, xlab = "Year", ylab = "River Volume (1e9 m^{3})")

# Plot the Nile data with xlab, ylab, main, and type arguments
plot(Nile, xlab = "Year", ylab = "River Volume (1e9 m^{3})", main = "Annual River Nile Volume at Aswan, 1871-1970", type ="b")

```
## Identifying sample frequency
```{r}
# Plot AirPassengers
plot(AirPassengers)

# View the start and end dates of AirPassengers
start(AirPassengers)
end(AirPassengers)



# Use time(), deltat(), frequency(), and cycle() with AirPassengers 
time(AirPassengers)
deltat(AirPassengers)
frequency(AirPassengers)
cycle(AirPassengers)



```

Add a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.

When you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).

## Discrete vs Continuous time Series

```{r}
# Plot the continuous_series using continuous time indexing
par(mfrow=c(2,1))
plot(continuous_time_index,continuous_series, type = "b")

# Make a discrete time index using 1:20 
discrete_time_index <-seq(1:20)

# Now plot the continuous_series using discrete time indexing
plot(discrete_time_index,continuous_series, type = "b")

```


## Missing Values
```{r}
# Plot the AirPassengers data
plot(AirPassengers)

# Compute the mean of AirPassengers
mean(AirPassengers)

# Impute mean values to NA in AirPassengers
AirPassengers[85:96] <- mean(AirPassengers, na.rm = TRUE)

# Generate another plot of AirPassengers
plot(AirPassengers)

# Add the complete AirPassengers data to your plot
rm(AirPassengers)
points(AirPassengers, type = "l", col = 2, lty = 3)

```

## Creating a time series object
```{r}
# Use print() and plot() to view data_vector
print(data_vector)
plot(data_vector)

# Convert data_vector to a ts object with start = 2004 and frequency = 4
time_series <- ts(data_vector, start = 2004, frequency = 4)

# Use print() and plot() to view time_series
print(time_series)
plot(time_series)

```

## Testing if objects are of tyoe `ts`

```{r}
# Check whether data_vector and time_series are ts objects
is.ts(data_vector)
is.ts(time_series)


# Check whether Nile is a ts object
is.ts(Nile)

# Check whether AirPassengers is a ts object
is.ts(AirPassengers)

```

## Plotting a time series
```{r}
data("EuStockMarkets")
eu_stocks <- EuStockMarkets
# Check whether eu_stocks is a ts object
is.ts(eu_stocks)

# View the start, end, and frequency of eu_stocks
start(eu_stocks)
end(eu_stocks)
frequency(eu_stocks)



# Generate a simple plot of eu_stocks
plot(eu_stocks)

# Use ts.plot with eu_stocks
ts.plot(eu_stocks, col = 1:4, xlab = "Year", ylab = "Index Value", main = "Major European Stock Indices, 1991-1998")

# Add a legend to your ts.plot
legend("topleft", colnames(eu_stocks), lty = 1, col = 1:4, bty = "n")

```

# Chapter 2 - Predicting the Future

## Removing trends in variability
```{r}
rapid_growth <- c(6.22644721334281, 6.10335382233382, 6.29634123585615, 6.24622955111167, 
6.22843195527522, 6.28229708775537, 6.20844741922452, 6.20972128804789, 
6.35827250415224, 6.28572984126078, 6.29387377889552, 6.16014735145226, 
6.31171477530532, 6.34460185650482, 6.25941927762177, 6.18867511691063, 
6.38790705099065, 6.38211034916024, 6.42322549478775, 6.4318422960411, 
6.40873477794284, 6.37508734151749, 6.31744522223519, 6.46788076206124, 
6.23382236782298, 6.40868419809582, 6.40283085141402, 6.41937842976356, 
6.30062859840956, 6.50848865168789, 6.53252585448752, 6.4225676888201, 
6.56693585306342, 6.54290112400289, 6.52492605202954, 6.49093634370728, 
6.46568125422392, 6.39947651373773, 6.50243362179406, 6.47845692668784, 
6.40703070676956, 6.54632451169874, 6.46396896781775, 6.75200389180284, 
6.50328328954751, 6.35174292371473, 6.67422454855503, 6.62219288746384, 
6.41476108293605, 6.43719203115034, 6.72539251138006, 6.46129116769531, 
6.60235483491626, 6.64936315848762, 6.53216909563942, 6.50393344502688, 
6.56939936271001, 6.82239761937805, 6.48632679303797, 6.55179037142821, 
6.52721681333954, 6.66151960536819, 6.57323912069037, 6.69491787322661, 
6.71025455545394, 6.4875098623154, 6.5976094065566, 6.65097574043069, 
6.46334569409202, 6.83756010365691, 6.52308725269382, 6.89596890707456, 
6.49963450012032, 6.70138073649028, 6.78378805946117, 6.82900956493073, 
6.87671045494522, 6.65586412994792, 6.78105582107621, 6.87869539045853, 
6.80567650980035, 6.9282886773914, 6.98021390044576, 6.78690965068204, 
6.79080811988766, 6.85687324422581, 6.77769160645684, 6.95059216963548, 
6.80362618929694, 6.98439998172557, 6.83937514670541, 6.82648372642902, 
6.76942049838646, 6.69844037789147, 6.91201386077297, 6.91589786378861, 
7.081279365728, 6.62269723643191, 6.85380081770285, 6.78729839010667, 
6.97997757673786, 7.00409281457646, 7.0301370200274, 6.88330838114885, 
6.85452432960534, 7.07142280689253, 7.11243105220367, 6.88448226209977, 
6.72947618664758, 7.1881141525679, 6.74800100349129, 7.09076506309115, 
7.15029262699804, 7.20731260322573, 7.00545657231082, 7.18905950184368, 
7.14576273692186, 6.96435196790078, 7.09347707755427, 6.98901289603892, 
7.15807071571375, 7.0861393036455, 6.96453837871522, 7.08007503607121, 
7.06184312320099, 6.970443266778, 7.26477812949222, 6.97621062749874, 
7.33910288239914, 7.29108186763736, 7.02794060038759, 7.16709321266713, 
7.3494070973242, 7.19511509230523, 7.18191405213385, 7.08107491410905, 
7.30144057114722, 7.12361532128538, 7.12106824351186, 7.29207052275869, 
7.19184016387511, 7.37117971137166, 7.22487208663911, 7.31558843331146, 
7.41453526842476, 7.44109377015137, 7.34630937946721, 7.39375688767601, 
7.5357548122989, 7.2230191007094, 7.27219792344658, 7.27754962755863, 
7.3651268103319, 7.42729707447298, 7.41553982321997, 7.17919122609255, 
7.18994543004138, 7.18773237814052, 7.34632391396533, 7.38162903767151, 
7.47790970913714, 7.31975684228401, 7.37281459204766, 7.39487334104795, 
7.34254155465234, 7.27206738741634, 7.42794795886081, 7.52332447049693, 
7.42260086748169, 7.51339668490706, 7.42193557510494, 7.48525411080987, 
7.41414498862142, 7.58580854844815, 7.62301240707291, 7.56480377155094, 
7.54523340699751, 7.30462202063205, 7.60781460317569, 7.4937562577587, 
7.58934505855497, 7.32446045453292, 7.4088965098932, 7.32862341178055, 
7.4363921995442, 7.39465343615595, 7.48845960812977, 7.35710160410629, 
7.5400883395603, 7.74888412502893, 7.5714673984741, 7.50674546593622, 
7.67545889501181, 7.72380440037869, 7.62667809326483, 7.63972455710096, 
7.605920282382, 7.67101631529587, 7.48172515305964, 7.60758361556912
)
# Log rapid_growth
linear_growth <- log(rapid_growth)
  
# Plot linear_growth using ts.plot()
 ts.plot(linear_growth)

```

## Linear differencing
```{r}
z <- c(6.22644721334281, 6.10335382233382, 6.29634123585615, 6.24622955111167, 
6.22843195527522, 6.28229708775537, 6.20844741922452, 6.20972128804789, 
6.35827250415224, 6.28572984126078, 6.29387377889552, 6.16014735145226, 
6.31171477530532, 6.34460185650482, 6.25941927762177, 6.18867511691063, 
6.38790705099065, 6.38211034916024, 6.42322549478775, 6.4318422960411, 
6.40873477794284, 6.37508734151749, 6.31744522223519, 6.46788076206124, 
6.23382236782298, 6.40868419809582, 6.40283085141402, 6.41937842976356, 
6.30062859840956, 6.50848865168789, 6.53252585448752, 6.4225676888201, 
6.56693585306342, 6.54290112400289, 6.52492605202954, 6.49093634370728, 
6.46568125422392, 6.39947651373773, 6.50243362179406, 6.47845692668784, 
6.40703070676956, 6.54632451169874, 6.46396896781775, 6.75200389180284, 
6.50328328954751, 6.35174292371473, 6.67422454855503, 6.62219288746384, 
6.41476108293605, 6.43719203115034, 6.72539251138006, 6.46129116769531, 
6.60235483491626, 6.64936315848762, 6.53216909563942, 6.50393344502688, 
6.56939936271001, 6.82239761937805, 6.48632679303797, 6.55179037142821, 
6.52721681333954, 6.66151960536819, 6.57323912069037, 6.69491787322661, 
6.71025455545394, 6.4875098623154, 6.5976094065566, 6.65097574043069, 
6.46334569409202, 6.83756010365691, 6.52308725269382, 6.89596890707456, 
6.49963450012032, 6.70138073649028, 6.78378805946117, 6.82900956493073, 
6.87671045494522, 6.65586412994792, 6.78105582107621, 6.87869539045853, 
6.80567650980035, 6.9282886773914, 6.98021390044576, 6.78690965068204, 
6.79080811988766, 6.85687324422581, 6.77769160645684, 6.95059216963548, 
6.80362618929694, 6.98439998172557, 6.83937514670541, 6.82648372642902, 
6.76942049838646, 6.69844037789147, 6.91201386077297, 6.91589786378861, 
7.081279365728, 6.62269723643191, 6.85380081770285, 6.78729839010667, 
6.97997757673786, 7.00409281457646, 7.0301370200274, 6.88330838114885, 
6.85452432960534, 7.07142280689253, 7.11243105220367, 6.88448226209977, 
6.72947618664758, 7.1881141525679, 6.74800100349129, 7.09076506309115, 
7.15029262699804, 7.20731260322573, 7.00545657231082, 7.18905950184368, 
7.14576273692186, 6.96435196790078, 7.09347707755427, 6.98901289603892, 
7.15807071571375, 7.0861393036455, 6.96453837871522, 7.08007503607121, 
7.06184312320099, 6.970443266778, 7.26477812949222, 6.97621062749874, 
7.33910288239914, 7.29108186763736, 7.02794060038759, 7.16709321266713, 
7.3494070973242, 7.19511509230523, 7.18191405213385, 7.08107491410905, 
7.30144057114722, 7.12361532128538, 7.12106824351186, 7.29207052275869, 
7.19184016387511, 7.37117971137166, 7.22487208663911, 7.31558843331146, 
7.41453526842476, 7.44109377015137, 7.34630937946721, 7.39375688767601, 
7.5357548122989, 7.2230191007094, 7.27219792344658, 7.27754962755863, 
7.3651268103319, 7.42729707447298, 7.41553982321997, 7.17919122609255, 
7.18994543004138, 7.18773237814052, 7.34632391396533, 7.38162903767151, 
7.47790970913714, 7.31975684228401, 7.37281459204766, 7.39487334104795, 
7.34254155465234, 7.27206738741634, 7.42794795886081, 7.52332447049693, 
7.42260086748169, 7.51339668490706, 7.42193557510494, 7.48525411080987, 
7.41414498862142, 7.58580854844815, 7.62301240707291, 7.56480377155094, 
7.54523340699751, 7.30462202063205, 7.60781460317569, 7.4937562577587, 
7.58934505855497, 7.32446045453292, 7.4088965098932, 7.32862341178055, 
7.4363921995442, 7.39465343615595, 7.48845960812977, 7.35710160410629, 
7.5400883395603, 7.74888412502893, 7.5714673984741, 7.50674546593622, 
7.67545889501181, 7.72380440037869, 7.62667809326483, 7.63972455710096, 
7.605920282382, 7.67101631529587, 7.48172515305964, 7.60758361556912
)
# Generate the first difference of z
dz <- diff(z)
  
# Plot dz
ts.plot(dz)

# View the length of z and dz, respectively
length(z)
length(dz)


```

## removing seasonal trend with seasonal differencing

```{r}
x <- 
c(-4.19803335973822, 9.56900905050747, 5.17514338906622, -9.69164636184119, 
-3.21529357476552, 10.8436693062559, 6.45215865708188, -10.8335590731441, 
-2.23535073514566, 10.119832962947, 6.57964573528545, -8.65656473226148, 
-2.51500138847406, 9.83743416797243, 7.38619432726046, -8.24350355631342, 
-4.26403257072438, 8.89886143008727, 8.54433581556254, -8.06691284107053, 
-4.02302530566536, 9.82267856454484, 7.77285238609707, -6.58777686807675, 
-3.45917112006633, 10.6138505016733, 7.37445047382904, -5.79871450522201, 
-1.20471055826558, 11.4292358845515, 7.57004694873634, -4.96838375977415, 
-2.00378659668805, 11.9413482982078, 9.40667210265289, -4.39658482425492, 
-1.55557889273259, 12.5998771289623, 8.50291637845889, -3.72896826710606, 
-2.82700000921691, 13.3759812867942, 8.12894114749321, -3.14924907770406, 
-2.79947272334396, 13.7105701226795, 6.75521688156725, -3.77974417787649, 
-3.76827394084617, 13.6253358560593, 6.53793056349892, -3.24909834265677, 
-5.02419102826334, 13.3553731337997, 6.93116080641335, -3.52735350362993, 
-5.19732896878058, 11.5797913233393, 7.16244857247412, -1.89460681643879, 
-5.77779700690048, 12.4826952884178, 6.20808841277938, -3.43403797043816, 
-7.08072100968159, 11.4136557746633, 6.74199013667799, -3.53237586423137, 
-8.39354230059932, 12.5072611286297, 6.47317547164243, -3.74524618197473, 
-9.42620870823793, 12.3808170457897, 8.04824272204917, -2.83152774381656, 
-7.30189285880787, 12.7658383061004, 8.22369850629786, -4.44813067987144, 
-6.96355759602497, 12.0340049862918, 7.57492470964176, -5.40221818593254, 
-6.56819814480662, 10.8964815061608, 7.27657057973042, -4.03787337902209, 
-6.72301328397502, 12.1808149692035, 8.28516213832065, -4.15934247966369, 
-6.36067044646075, 12.7530177649457, 8.66591165178255, -5.44053784032607, 
-4.87493170537183, 12.6001974041011, 8.16258920594197, -6.53957167229621
)
# Generate a diff of x with lag = 4. Save this to dx
dx <- diff(x, lag= 4)
  
# Plot dx
ts.plot(dx)

# View the length of x and dx, respectively 
length(x)
length(dx)


```

## Simulate the White Noise Model
```{r}
# Simulate a WN model with list(order = c(0, 0, 0))
white_noise <- arima.sim(model = list(order = c(0, 0, 0)), n = 100)

# Plot your white_noise data
ts.plot(white_noise)

# Simulate from the WN model with: mean = 100, sd = 10
white_noise_2 <- arima.sim(model = list(order = c(0, 0, 0)), n = 100, mean = 100, sd = 10)

# Plot your white_noise_2 data
ts.plot(white_noise_2)

```

## Estimate the White Noise Model

```{r}
y <- structure(c(109.761335203807, 98.3161015661823, 100.63294691568, 
88.7433987127593, 101.872377016961, 104.628357308022, 96.6446185677499, 
102.861935537741, 112.762472095071, 82.2321895604405, 88.9443425162465, 
94.603184959066, 105.611134283638, 113.827759889612, 104.823186799211, 
101.296287605209, 82.9845883499902, 88.9605839815819, 100.600456607996, 
91.035249256563, 100.1928594042, 95.3253727241077, 94.5864315510523, 
121.358295918349, 87.3787382991481, 96.8900652561591, 90.5130974518601, 
99.9084292221271, 102.569341770317, 104.961440623652, 104.734635474905, 
88.0046450549299, 100.779432761891, 121.647764133843, 85.7708319146464, 
79.1542817751461, 98.1884698770029, 99.9000575918412, 98.9108408854003, 
101.644224781541, 102.795262786231, 84.6511153287627, 96.478695879623, 
105.815471102771, 98.5186873070791, 105.24366218935, 109.612642086809, 
85.1420130618153, 82.8144174251857, 103.036291436483, 93.5696735465724, 
98.0892223944794, 81.2546061795588, 109.185538293753, 80.4318090604482, 
103.559532399435, 80.2226855501286, 84.9747654707037, 107.783629803383, 
92.612875815647, 99.8029344059519, 107.250849637866, 98.6637847611836, 
91.9227453154993, 98.3264180218282, 112.734017659718, 96.0281067924588, 
92.6490908853105, 83.0848439102975, 97.2219648542801, 106.613612756687, 
97.3694287042478, 108.784654442207, 104.918584253723, 84.4434297475219, 
85.6078609998276, 96.5152905606852, 94.1810528014953, 85.0285128829162, 
63.2662175136146, 87.2213673144322, 103.522954295167, 105.602155542432, 
103.260391527392, 101.115192549417, 108.456965675889, 97.676314341323, 
103.010808274931, 100.617555510141, 105.581077298303, 98.7272241180465, 
98.4399563595089, 90.7821910344929, 92.7459923258825, 102.937624393826, 
83.9530591640689, 110.159366234931, 104.175781699309, 99.2787550528578, 
103.251148823917), .Tsp = c(1, 100, 1), class = "ts")

# Fit the WN model to y using the arima command
arima(y, order = c(0,0,0))

# Calculate the sample mean and sample variance of y
mean(y)
var(y)


```

## Simulate the Random Walk Model

```{r}
# Generate a RW model using arima.sim
random_walk <- arima.sim(model = list(order = c(0, 1, 0)), n = 100)

# Plot random_walk
ts.plot(random_walk)

# Calculate the first difference series
random_walk_diff <- diff(random_walk)

# Plot random_walk_diff
ts.plot(random_walk_diff)
  
```

## Simulate the RW model with a drift
```{r}
# Generate a RW model with a drift uing arima.sim
rw_drift <- arima.sim(model = list(order = c(0,1,0)), n = 100, mean = 1)

# Plot rw_drift
ts.plot(rw_drift)


# Calculate the first difference series
rw_drift_diff <- diff(rw_drift)

# Plot rw_drift_diff
ts.plot(rw_drift_diff)

```

## Estimate the Random Walk model
```{r}
structure(c(0, 0.840799690805892, 0.637459389341622, 0.757921658699468, 
0.51187422142312, 0.113766891514572, 0.278972783338605, 0.277594629974007, 
0.603058933300874, 2.91209633642732, 3.18199136208394, 2.55157314365465, 
3.26756203062092, 4.99979931564387, 7.10915802250204, 8.01070864926096, 
8.23772461506037, 8.70157227268806, 9.05126103820082, 13.3200713895243, 
12.167575412894, 11.5324303105757, 12.2601004793325, 12.5767819422196, 
12.6632633175434, 12.7256680349732, 13.1994836806694, 12.8396495033226, 
13.5061940806857, 15.4816848106994, 16.177107725103, 16.8365295156745, 
16.6163362311588, 16.1808336886557, 16.9662659934889, 16.7270308469477, 
17.6561798270108, 20.8901636724502, 20.0567603436916, 22.4168556898516, 
23.1628256130545, 22.9168361903724, 21.9326982045095, 22.65474670326, 
23.6325743016245, 24.8637728096747, 25.5358779389007, 27.2225699268809, 
27.3721605280673, 29.0197579376152, 30.86984194858, 32.4859913444825, 
33.1883373188887, 33.7998279266371, 32.7718376006665, 33.3293449130956, 
36.0168049817462, 36.4458500836042, 38.2388466589622, 39.1157216648363, 
38.7992108420878, 39.2275167845668, 37.5690113188738, 40.0882062820111, 
40.5380768982454, 40.757863652738, 41.5757014101746, 41.1067983652453, 
41.1064560275605, 40.645532029424, 39.5554850868954, 40.4312197530977, 
41.9604182429803, 43.6866496098288, 45.2350442037095, 45.9024581686138, 
47.540457130699, 49.0971826208823, 48.9170239101692, 48.0796342742815, 
46.7765324003763, 47.9775098038997, 46.4334192966129, 45.9453639155814, 
47.0727461261722, 47.1890042341391, 51.2925270988872, 52.1247376806133, 
51.3796798321698, 52.127045835946, 51.2230171217941, 52.6301981357515, 
52.4262448587789, 51.3564738575462, 52.2017865810857, 53.3817249795485, 
55.0244437963563, 55.9303590282021, 55.5117187960721, 58.308031867784, 
58.1183345226755), .Tsp = c(0, 100, 1), class = "ts")
# Difference your random_walk data
rw_diff <- diff(random_walk)

# Plot rw_diff
ts.plot(rw_diff)

# Now fit the WN model to the differenced data
model_wn <- arima(rw_diff, order = c(0, 0, 0))

# Store the value of the estimated time trend (intercept)
int_wn <- model_wn$coef

# Plot the original random_walk data
ts.plot(random_walk)

# Use abline(0, ...) to add time trend to the figure
abline(0, int_wn)

```

## Are WN or RW models stationary?
```{r}
# Use arima.sim() to generate WN data
white_noise <- arima.sim(model = list(order = c(0, 0, 0)), n = 100)

# Use cumsum() to convert your WN data to RW
random_walk <- cumsum(white_noise)
  
# Use arima.sim() to generate WN drift data
wn_drift <- arima.sim(model = list(order = c(0, 0, 0)), n = 100, mean = 0.4)
  
# Use cumsum() to convert your WN drift data to RW
rw_drift <- cumsum(wn_drift)

# Plot all four data objects
plot.ts(cbind(white_noise, random_walk, wn_drift, rw_drift))

```

# Chapter 3 - Correlation Analysis

# Chapter 4 - Autoregression

# Chapter 4 - Simple Moving Average
